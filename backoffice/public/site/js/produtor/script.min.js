var Admin=Admin||function(t){function e(e){t("#x1").val(e.x),t("#y1").val(e.y),t("#x2").val(e.x2),t("#y2").val(e.y2),t("#w").val(e.w),t("#h").val(e.h)}function i(){t("#coords input").val("")}t(".input-file").change(function(){t(this).parent().find(".bt-file").text(t(this).val())}),t(".bt-file").click(function(){t(this).parent().find(".input-file").click()}),t("textarea[maxlength]").keydown(function(e){var i=e.which;if(!(i>=37&&40>=i||8==i||46==i))return t(this).val().length<t(this).attr("maxlength")});var a=function(){var t=0;return function(e,i){clearTimeout(t),t=setTimeout(e,i)}}();t(".input-search").keyup(function(){var e=t(this).val(),i=t(".select-search").val();a(function(){t.ajax({url:baseurl+"produtor/"+controller+"/searchAjax/"+e+"/"+i,type:"GET",dataType:"json"}).done(function(e){var i="";t.each(e.id,function(t){i+='\n                            <tr class="teste">\n                                <td> '+e.id[t]+'</td>\n                                <td class="td-gravatar"> '+e.gravatar[t]+'</td>\n                                <td class="td-name"> '+e.name[t]+'</td>\n                                <td class="td-email"> '+e.email[t]+"</td>\n                            </tr>",i+='\n                            <tr class="teste">\n                                <td> '+e.id[t]+'</td>\n                                <td class="td-gravatar"> '+e.gravatar[t]+'</td>\n                                <td class="td-name"> '+e.name[t]+'</td>\n                                <td class="td-email"> '+e.email[t]+"</td>\n                            </tr>"}),t(".teste").hide(),t(".imprimir-tr").after(i),console.log("success")}).fail(function(){console.log("error")}).always(function(){console.log("complete")})},2e3)});t(".bt-tooltip").tooltip(),t("#money").maskMoney({prefix:"R$ ",allowNegative:!0,thousands:".",decimal:",",affixesStay:!1});var n;t("#cropbox").Jcrop({onChange:e,onSelect:e,onRelease:i,maxSize:[imageWidthResize,imageHeightResize],setSelect:[imageWidthResize,imageHeightResize,0,0]},function(){n=this}),t("#coords").on("change","input",function(){var e=t("#x1").val(),i=t("#x2").val(),a=t("#y1").val(),o=t("#y2").val();n.setSelect([e,a,i,o])});var o=new Array,r=new Array,s={},l={},c={},d={},u={};s={settings:{debug:!0,meta:{controller:-1,currentUser:-1,homeURL:-1},init:function(){m("Initializing Settings"),s.settings.meta.controller=t('meta[name="controller"]').attr("content"),s.settings.meta.currentUser=t('meta[name="userid"]').attr("content"),s.settings.meta.homeURL=t('meta[name="url"]').attr("content"),m("Initialized Settings")}},cache:{window:window,document:document},home_url:function(t){return"undefined"==typeof t&&(t=""),s.settings.meta.homeURL+t},log:function(t){s.settings.debug&&console.log(t)}};var m=s.log;return l={ajaxUrl:s.home_url("ajax"),checkAuth:function(t){return"function"==typeof t&&-1==s.settings.meta.currentUser?(t.call(),!1):void 0},call:function(e,i,a,n){l.checkAuth(n),t.ajax({type:"POST",url:l.ajaxUrl+e,dataType:"json",data:i,success:a})},get:function(e,i,a,n){l.checkAuth(n),t.ajax({type:"GET",url:l.ajaxUrl+e,dataType:"json",data:i,success:a})}},c={endpoints:{addGallery:function(){var e=t(this).data("count"),i=t(".cropContainerHeader"+e).length,a='<div class="form-group">';a+='<label class="col-sm-2 control-label" for="status"></label>',a+='<div class="col-sm-5">',a+='<div class="col-lg-6 cropContainerHeader'+e+'">',a+='<div id="'+e+"yourId"+i+'"></div>',a+='<input type="hidden" name="photos'+e+'[]" id="'+e+"cropOutput"+i+'">',a+="<legend></legend>",a+='<span class="btn" id="'+e+"myDivId"+i+'"><span class="glyphicon glyphicon-open"></span>',a+="</div>",a+="</div>",a+="</div>",t("#formGroupGallery"+e).next().append(a),cropUrl="3"==e?"produtor/attraction/img_crop_to_file/mobile":"produtor/attraction/img_crop_to_file",r[r.length]={uploadUrl:baseurl+"produtor/attraction/img_save_to_file",modal:!0,cropUrl:baseurl+cropUrl,customUploadButtonId:e+"myDivId"+i,outputUrlId:e+"cropOutput"+i,typeofimage:parseInt(e),loaderHtml:'<div class="loader bubblingG"><span id="bubblingG_1"></span><span id="bubblingG_2"></span><span id="bubblingG_3"></span></div> ',onBeforeImgUpload:function(){console.log("onBeforeImgUpload")},onAfterImgUpload:function(){console.log("onAfterImgUpload")},onImgDrag:function(){console.log("onImgDrag")},onImgZoom:function(){console.log("onImgZoom")},onBeforeImgCrop:function(){console.log("onBeforeImgCrop")},onAfterImgCrop:function(){console.log("onAfterImgCrop")}},console.log(r),o[o.length]=new Croppic(e+"yourId"+i,r[r.length-1])},removeImage:function(){console.log(t(this).data("id")),t("."+t(this).data("id")).remove()},removeEntries:function(e){e.preventDefault(),alertify.set({labels:{ok:"Remover",cancel:"Cancelar"}}),alertify.confirm("Você tem certeza que deseja remover os itens selecionados?",function(i){i&&t(e.target).parents("form").submit()})},removePhotos:function(e){e.preventDefault(),alertify.set({labels:{ok:"Remover",cancel:"Cancelar"}}),alertify.confirm("Você tem certeza que deseja remover os itens selecionados?",function(e){e&&t.each(t(".checklist:checked"),function(){var e=t(this).val();text='<input type="hidden" name="removePhotos[]" value="'+e+'" />',t("#removeList").append(text),t("#image_"+e).remove()})})},selectAll:function(){t(this).is(":checked")?t(".mark-i:checkbox:not(:checked)").click():t(".mark-i:checkbox:checked").click()},selectAllImages:function(){var e=t(this);t(".mark-img").each(1==e.is(":checked")?function(){t(this).attr("checked","checked"),e.attr("checked","checked")}:function(){t(this).removeAttr("checked"),e.removeAttr("checked")})},markImage:function(){t(this).each(function(){0==t(this).is(":checked")&&t("#markImage").removeAttr("checked")})},cancelPhoto:function(){var e=t(this).attr("alt");t(e).remove()},status:function(e){e.preventDefault();var i=t(this),a=(t(this).attr("data-id"),t(this).attr("data-controller"));t.post(Admin.home_url("produtor/"+a+"/status"),{id:t(this).attr("data-id")},function(e){parseInt(e)?(t(i).find("i").attr("class","icon-circle"),alertify.success("Registro ativado com sucesso.")):(t(i).find("i").attr("class","icon-circle-blank"),alertify.success("Registro desativado com sucesso."))})},read:function(e){e.preventDefault();var i=t(this),a=(t(this).attr("data-id"),t(this).attr("data-controller"));t.post(Admin.home_url("produtor/"+a+"/read"),{id:t(this).attr("data-id")},function(e){parseInt(e)?(t(i).find("i").attr("class","icon-envelope-alt"),t(i).parents("tr").addClass("warning"),t(i).attr("title","Marcar como não lido"),alertify.success("Contato marcado como não lido.")):(t(i).find("i").attr("class","icon-envelope"),t(i).parents("tr").removeClass("warning"),t(i).attr("title","Marcar como lido"),alertify.success("Contato marcado como lido."))})},featured:function(e){e.preventDefault();var i=t(this),a=(t(this).attr("data-id"),t(this).attr("data-controller"));t.post(Admin.home_url("produtor/"+a+"/featured"),{id:t(this).attr("data-id")},function(e){parseInt(e)?(t(i).find("i").attr("class","icon-star"),alertify.success("Adicionado destaque com sucesso.")):(t(i).find("i").attr("class","icon-star-empty"),alertify.success("Removido destaque com sucesso."))})},fillLoremIpsum:function(){t("#register").find("input:text, textarea").each(function(){var e=lorem.ipsum("p4").replace(/(<([^>]+)>)/gi,"");if(t(this).attr("readonly")||t(this).attr("disabled")||t(this).hasClass("select2-input"))return!0;if(t(this).attr("maxlength")&&(e=e.slice(0,t(this).attr("maxlength"))),t(this).hasClass("tinymce"))for(editorID in tinyMCE.editors)tinyMCE.editors[editorID].setContent(lorem.ipsum("p4"));t(this).hasClass("email")&&(e="lorem@ipsum.com"),t(this).hasClass("url")&&(e="http://www.loremipsum.com"),t(this).hasClass("digits")&&(e=Math.floor(10*Math.random()+2e3)),t(this).val(e)})},forgetPassword:function(e){e.preventDefault(),alertify.set({labels:{ok:"Enviar",cancel:"Cancelar"}}),alertify.prompt("Qual o email que você deseja recuperar?",function(e,i){e&&t.ajax({url:Admin.home_url()+"produtor/main/forgetPassword",type:"POST",dataType:"json",data:{email:i},success:function(t){t.status?alertify.success(t.message):alertify.error(t.message)}})})},toggleDuplicate:function(e){e.preventDefault(),t("#duplicate").click()}},bindEvents:function(){m("Binding Events"),t("[data-event]").each(function(){var e=t(this),i=e.attr("data-method")||"click",a=e.attr("data-event"),n="true"==e.attr("data-bound");m(i),"undefined"!=typeof c.endpoints[a]&&(n||(e.attr("data-bound","true"),e.on(i,c.endpoints[a])))}),m("Events Bound")},init:function(){c.bindEvents()}},d={logic:{},initTinyMCE:function(){if("undefined"!=typeof tinyMCE){var e=new Array;t(".tinymce").each(function(){e.push(t(this).attr("id"))}),tinyMCE.init({theme:"advanced",mode:"exact",elements:e.join(","),language:"pt",relative_urls:!1,convert_urls:!1,plugins:"inlinepopups",theme_advanced_buttons1:"bold,italic,underline,justifyleft,justifycenter,justifyright,justifyfull,image",theme_advanced_buttons2:"bullist,numlist,outdent,indent,undo,redo,link,unlink,code",theme_advanced_buttons3:"hr,removeformat,sub,sup,formatselect",file_browser_callback:"tinyBrowser",theme_advanced_toolbar_align:"left",theme_advanced_toolbar_location:"top",onchange_callback:function(e){tinyMCE.triggerSave(),t("#"+e.id).valid()}})}},initLists:function(){t(".list").length>0&&t(".list").sortable({cursor:"move",revert:!0,placeholder:"span3 gallery-item"}).disableSelection()},initLimiter:function(){"undefined"!=typeof t.fn.inputlimiter&&t("input[maxlength], textarea[maxlength]").inputlimiter({boxClass:"label",limit:t(this).attr("maxlength"),remText:"%n caractere%s restando...",limitText:"Limite de %n caractere%s."})},initBootstrap:function(){t('[rel="popover"]').popover(),t('[rel="tooltip"]').tooltip()},initValidator:function(){t.validator.setDefaults({ignore:[]}),t("#register").find("input:text, select, textarea").addClass("required"),t("#register .ignore, .select2-input, .ignore-input").removeClass("required"),t("#register input:visible:not([readonly])").eq(0).focus(),t("#register").validate({ignore:".ignore-input",rules:{password:"required",password_confirm:{equalTo:"#password"}},highlight:function(e,i){t(e).parents(".control-group").addClass(i),t("label.error").each(function(){t(this).appendTo(t(this).parent())})},unhighlight:function(e,i){t(e).parents(".control-group").removeClass(i)}})},initUploader:function(){if(t("#upFile").length>0){new qq.FileUploader({element:document.getElementById("upFile"),action:baseurl+"js/produtor/upload.php",onSubmit:function(e){var i='<div id="progress_'+e+'" class="progress"><div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 100%;"></div></div>';t(".upload-list").before(i)},onProgress:function(e,i,a,n){var o=a/n*100;t("#progress_"+e+" .bar").width(o+"%")},onComplete:function(e,i,a){var n='<li id="img_'+e+'" class="span3 gallery-new-item"><div class="thumbnail" title="Clique para remover esta imagem"><img src="'+baseurl+"uploads/temp/"+a.fileName+'" alt="#img_'+e+'" data-event="cancelPhoto" /><input type="hidden" name="galleries[]" value="'+a.fileName+'" /></div></li>';t("#progress_"+e).animate({opacity:0},function(){t(this).slideUp(1e3)}),t(n).hide().appendTo(".upload-list").fadeIn(1e3),Admin.rebindEvents()}})}},initSelect2:function(){t(".select2").each(function(){var e=this;t(e).select2({tags:t(e).data("tags").toString().split(","),formatSelection:function(t){return'<i class="icon-tag"></i> '+t.text},formatResult:function(t){return'<i class="icon-tag"></i> '+t.text}})})},initPickadate:function(){t(".pickadate").each(function(){var e=t(this).pickadate({formatSubmit:"yyyy-mm-dd"});if(t(this).attr("data-value")){var i=new Date(t(this).attr("data-value"));e.data("pickadate").setDate(i.getFullYear(),i.getMonth()+1,i.getDate()+1)}})},initCropAjax:function(){t("#coords").submit(function(e){var i=t(this).serialize(),a=t(this).attr("action");t("#cropsubmit").attr("disabled","disabled"),t(".progress").removeClass("hide"),t.ajax({url:a,type:"POST",data:i,success:function(e){if(t("#preview").modal("hide"),1==e.status){alertify.success("Imagem cortada com sucesso!"),"none"==t("#previewresize").css("display")&&t("#previewresize").show();var i=baseurl+e.image+"?"+Math.floor(1e4*Math.random()+1);t("#image_resize").removeAttr("src"),t("#image_resize").attr("src",i)}else alertify.error(e.message);t("#cropsubmit").attr("disabled",!1),t(".progress").addClass("hide")},error:function(){alert("Ocorreu um erro"),t("#cropsubmit").attr("disabled",!1),t(".progress").addClass("hide")}}),e.preventDefault()})},initDatetimepicker:function(){"undefined"!=typeof t.fn.datetimepicker&&(t("#datetimepicker1").datetimepicker({startDate:new Date,language:"pt-BR"}),t("#datetimepicker1 input").focus(function(){t(this).next().click()}))},init:function(){m("Initializing App"),s.settings.init(),d.initTinyMCE(),d.initLists(),d.initLimiter(),d.initBootstrap(),d.initCropAjax(),d.initValidator(),d.initUploader(),d.initSelect2(),d.initPickadate(),d.initDatetimepicker(),c.init(),m("Initialized App")}},u={init:d.init,rebindEvents:c.bindEvents,home_url:s.home_url,meta:s.settings.meta}}(window.jQuery);jQuery(document).ready(Admin.init);