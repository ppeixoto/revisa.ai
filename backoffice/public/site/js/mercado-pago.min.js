!function(e,o,t,a,r){function n(e,o){if(a("#portion_buy").html(""),a(".msg-error").html(""),a(".msg-reply").html(""),200!=e)return a("#cardNumber").focus(),a(".msg-error").html("<strong>Falha em carregar parcelas, tente novamente, e verifique se seu cartão de crédito está informado corretamente</strong>");var t=o[0].payer_costs,n=[];for(var i in t){var d=t[i].installments;if("undefined"!=typeof d&&"undefined"!=typeof r&&r&&d<=r.maxInstallments){var s=0;d>r.maxInstallmentsWithoutInterests&&(s=r.jurosParcelamento[d]);var l=t[i].total_amount,c=!0;s>0?l+=s*l/100:c=!1;var u=l/d;u=u.toFixed(2).split(".").join(",");var m='                    <option data-total="'+l.toFixed(2)+'" value="'+d+'">                        '+t[i].installments+"                        x de R$ "+u.toLocaleString("pt-BR")+" "+(c?"(com juros)":"")+"</option>";n.push(m)}}a("#portion_buy").html(n.join(""))}function d(e,o){if(200!=e)return console.error("payment method info error: "+o),a(".msg-error").html("<strong>Falha em carregar parcelas, tente novamente, e verifique se seu cartão de crédito está informado corretamente</strong>");console.log(o);var r=a('input[name="paymentMethodId"]');if(r)a('input[name="paymentMethodId"]').val(o[0].id),console.log("Adicionando payment method info 2",r.value);else{console.log("Adicionando payment method info",o);var n=t.createElement("input");n.setattribute("name","paymentMethodId"),n.setAttribute("type","hidden"),n.setAttribute("value",o[0].id),form.appendChild(n)}}function s(){clearInterval(f)}function l(e,o){if(200!=e&&201!=e){a("#cardNumber").focus();var r=o.cause.reduce(function(e,o){var t="undefined"!=typeof p[o.code]?p[o.code]:"";return""===t&&(t="undefined"!=typeof m[o.code]?m[o.code]:o.description),e.push(t),e},[]);return a('button[type="submit"]').attr("disabled",!1),a(".msg-error").html("<strong>"+r.join("<br/>")+"</strong>")}a("#totalInputWithInterest").val(a("#portion_buy").find("option:selected").attr("data-total"));var n=t.querySelector("#pay"),i=t.createElement("input");i.setAttribute("name","token"),i.setAttribute("type","hidden"),i.setAttribute("value",o.id),n.appendChild(i),c(a(n).serialize())}function c(e){a(".loading-payment").show(),a("#loadCompleto").show(),a.ajax({url:baseurl+"send-payment-mercadopago",type:"POST",dataType:"json",data:e}).done(function(e){if(console.log(e),e.status){if("undefined"!=typeof e.data){a(".info-modal-request").html(e.data);var o=baseurl+"compra-concluida/"+e.data;a(location).attr("href",o)}else a(".msg-error").html("<strong>Compra feita com sucesso, olhe em meus pedidos o andamento do seu status</strong>");h=!0}else if(u(e.message),"undefined"!=typeof e.attrs&&null!=e.attrs&&a('input[name="'+e.attrs+'"]').parent().addClass("input-required"),"undefined"!=typeof e.inputsHtml&&e.inputsHtml.length>0){var t="";for(i=0;i<e.inputsHtml.length;i++)t+=e.inputsHtml[i];a(".error_card").html(t),a(".error_card").find("li").addClass("input-required"),a(".error_card").find("input").attr("required",!0)}}).error(function(){u("Ocorreu um erro na sua requisição, por favor tente novamente.")}).always(function(){a(".loading-payment").hide(),a("#loadCompleto").hide()})}function u(e){a(".modal-request").fadeOut("fast"),console.log("Mensagem de error: ".message),a(".msg-error").html(e),o.Mercadopago.clearSession(),a('button[type="submit"]').attr("disabled",!1)}o.Mercadopago.getIdentificationTypes(),a(".changePaymentType").on("click",function(e){var o=a(this).data("value");a('input[name="payment_type"]').val(o)});var m={205:"Digite o número do seu cartão.",208:"Escolha um mês.",209:"Escolha um ano.",212:"Informe seu documento.",213:"Informe seu documento.",214:"Informe seu documento.",220:"Informe seu banco emissor.",221:"Digite o nome e sobrenome.",224:"Digite o código de segurança.",E301:"Há algo de errado com o número do cartão. Digite novamente.",E302:"Confira o código de segurança do cartão.",316:"Por favor, digite um nome válido.",322:"Confira seu documento.",323:"Confira seu documento.",324:"Confira seu documento.",325:"Confira o mês de validade.",326:"Confira o ano de validade.",3031:"Código de segurança do Cartão não pode ser vazio"},p={106:"Não pode efetuar pagamentos a usuários de outros países.",109:"A operadora do cartão não processa pagamentos parcelados. Escolha outro cartão ou outra forma de pagamento.",126:"Não conseguimos processar seu pagamento. Tente novamente ou utilize outro cartão",129:"A operadora do cartão não processa pagamentos para o valor selecionado. Escolha outro cartão ou outra forma de pagamento.",145:"Não conseguimos processar seu pagamento. Tente novamente ou utilize outro cartão",150:"Você não pode efetuar pagamentos.",151:"Você não pode efetuar pagamentos.",160:"Não conseguimos processar seu pagamento. Tente novamente ou utilize outro cartão",204:"A operadora do cartão não está disponível neste momento. Escolha outro cartão ou outra forma de pagamento.",801:"Você efetuou um pagamento no mesmo valor alguns minutos atrás. Aguarde mais um pouco para tentar novamente."},v=parseFloat(a("#totalInput").val());a(t).on("keyup","#cardNumber",function(){var e=a(this).val().replace(/[^\d]/,"").substring(0,6),t=a("#cardId").val();console.log(e,"no bin",t),console.log(e),e.length>=6&&(o.Mercadopago.getPaymentMethod({bin:e},d),o.Mercadopago.getInstallments({bin:e,amount:v},n))}),a(".hideCard").click(function(){a(".showCard").show(),a(".hideCard").hide()}),a(t).ready(function(){var e=a("#tamanhoCard").val();console.log(e),null!=e&&e>0?(a("#cardNumber").remove(),a("#holder_name").remove(),a("#cardExpirationMonth").remove(),a("#cardExpirationYear").remove(),a("#card_code").remove(),a(".divMeusCartoes").show(),a("#cvvDiv").hide(),a(".showCard").hide(),a(".showParcelas").hide()):0==e&&(a(".divMeusCartoes").hide(),a(".showCard").show(),a(".showParcelas").show())}),a("#cardId").change(function(){var e=(this.value,a(this).find(":selected").attr("first_six_digits")),t=a(this).find(":selected").val();if(e&&e.length>=6)a("#cvvDiv").show(),a("#cardNumber").remove(),a("#holder_name").remove(),a("#cardExpirationMonth").remove(),a("#cardExpirationYear").remove(),a("#card_code").remove(),a(".hide").show(),a("#cvv").prop("required",!0),a("#cvv").attr("required",!0),a(".showCard").hide(),a(".showParcelas").show(),o.Mercadopago.getPaymentMethod({bin:e},d),o.Mercadopago.getInstallments({bin:e,amount:v},n);else if("show"==t){a("#cvvDiv").hide();var r=a("#limitAno").val(),i="";a("#cvv").prop("required",!1),a("#cvv").attr("required",!1);for(var s=r;s<=2050;s++)i+='<option value="'+s+'">'+s+"</option>";a('<input id="cardNumber" data-checkout="cardNumber" onselectstart="return false" onpaste="return false" onCopy="return false" onCut="return false" onDrag="return false" onDrop="return false" autocomplete="off" type="text"  placeholder="Número do cartão de crédito" class="only-digit form-control" autocomplete="false" style="width: 100%; margin-bottom: 10px;" >').insertAfter("#labelNCartao"),a('<input id="holder_name" data-checkout="cardholderName" class="only-letters form-control" placeholder="Nome impresso no cartão de crédito" type="text" maxlength="20" autocomplete="false" style=" margin-bottom: 10px;">').insertAfter("#labelNomeCartao"),a('<select id="cardExpirationMonth" class="form-control" data-checkout="cardExpirationMonth" autocomplete="false" style=" margin-bottom: 10px;"><option value="01">01</option><option value="02">02</option><option value="03">03</option><option value="04">04</option><option value="05">05</option><option value="06">06</option><option value="07">07</option><option value="08">08</option><option value="09">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option</select>').insertAfter("#labelMesCartao"),a('<select id="cardExpirationYear" data-checkout="cardExpirationYear" class="form-control" style=" margin-bottom: 10px;" autocomplete="false">'+i+"</select>").insertAfter("#labelAnoCartao"),a('<input  id="card_code" class="form-control" data-checkout="securityCode" onselectstart="return false" onpaste="return false" onCopy="return false" onCut="return false" onDrag="return false" onDrop="return false" autocomplete="off" name="card_code" type="text" maxlength="4" class="only-digit" style=" margin-bottom: 10px;" autocomplete="false">').insertAfter("#labelCodCartao"),a(".showCard").show(),a(".showParcelas").show()}else a("#cvvDiv").hide(),a("#cardNumber").remove(),a("#holder_name").remove(),a("#cardExpirationMonth").remove(),a("#cardExpirationYear").remove(),a("#card_code").remove(),a(".showCard").hide(),a("#portion_buy").empty(),a(".showParcelas").hide()});var h=!1;if(console.log(a("#docType").length,a("#docType").attr("cnpj")),a("#docType").length>0&&a("#docType").attr("cnpj")){console.log("aqui2");var f=setInterval(function(){console.log("aqui"),a("#docType").find("option").length>0&&(a("#docType").val("CNPJ"),s())},1e3)}a("#boleto-tab").on("click",function(e){a("#cvv").attr("required",!1)}),a("#card-tab").on("click",function(e){console.log("card",a("#cardId").val()),""!=a("#cardId").val()&&"value"==a("#cardId").val()&&a("#cvv").attr("required",!0);var o=a("#tamanhoCard").val();"value"!=a("#cardId").val()&&""!=a("#cardId").val()&&"undefined"!=typeof a("#tamanhoCard").val().currentTarget&&"undefined"!=a("#tamanhoCard").val()||a(".showEnd").show(),null!=o&&o>0&&""==a("#cardId").val()&&(a(".showEnd").hide(),a("#cvv").attr("required",!1))}),a("#pay").on("submit",function(e){e.preventDefault();var r=a('input[name="payment_type"]').val();if(!h){var n=t.querySelector("#pay");a('button[type="submit"]').attr("disabled",!0);var i=a("#cardId").val();return"show"==i&&a("#cardId").val(null),"1"==r?o.Mercadopago.createToken(n,l):c(a(n).serialize()),!1}}),a(".labels-payment").show(),a(".waiting-payment-method").hide(),a('input[name="myCard"]').change(function(){"0"==a(this).val()?(a("#orderCard").show(),a(".installmentcount").hide()):(card.brand=a(this).data("brand"),card.hashNumber=a(this).val(),getInstallments(),a("#orderCard").hide(),a(".installmentcount").show())})}(environment,window,document,jQuery,eventData);